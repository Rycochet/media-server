# GPU support
services:
  # https://instinct.docs.amd.com/projects/container-toolkit/en/latest/index.html
  amd:
    environment:
      AMD_VISIBLE_DEVICES: "all"

  # https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/index.html
  nvidia:
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    environment:
      NVIDIA_DRIVER_CAPABILITIES: "all"
      NVIDIA_VISIBLE_DEVICES: "all"

  none: # No GPU support - might report a parsing error in VSCode
